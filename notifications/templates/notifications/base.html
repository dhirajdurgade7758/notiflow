<!DOCTYPE html>
<html>
<head>
  <title>Notiflow</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://unpkg.com/htmx.org@1.9.2"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap 5 JS (important for modal behavior) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</head>
<body>
  {% if messages %}
    <div class="container mt-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <a href="{% url 'inapp_notifications' %}" class="btn btn-outline-info">ðŸ”” View In-App Alerts</a>
  {% if request.user.is_authenticated %}
{% if unread_alerts %}
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 5;">
    {% for alert in unread_alerts %}
      <div class="toast show" role="alert" style="min-width: 300px;">
        <div class="toast-header">
          <strong class="me-auto">{{ alert.title }}</strong>
          <small class="text-muted">Just now</small>
        </div>
        <div class="toast-body">
          {{ alert.message }}
        </div>
      </div>
    {% endfor %}
  </div>
{% endif %}

{% endif %}
<a href="{% url 'user_dashboard' %}" class="btn btn-outline-dark">ðŸ“Š Dashboard</a>
{% if request.user.is_staff %}
  <a href="{% url 'admin_reminders' %}" class="btn btn-outline-danger">ðŸ”’ Admin Reminder Panel</a>
{% endif %}



<div id="toast-container"
     hx-get="{% url 'fetch_toasts' %}"
     hx-trigger="every 5s"
     hx-swap="innerHTML"
     class="position-fixed bottom-0 end-0 p-3"
     style="z-index: 9999;">
</div>

  {% block content %}{% endblock %}

  <script>
  document.addEventListener('htmx:afterSwap', function(evt) {
    const toasts = document.querySelectorAll('.toast');
    toasts.forEach(toast => {
      setTimeout(() => {
        toast.classList.remove('show');
        toast.classList.add('hide');
      }, 5000);  // 5 seconds
    });
  });
</script>

</body>
</html>
